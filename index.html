<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Caleufu Yerbas Agroecologicas</title>
  <link rel="stylesheet" href="assets/css/style4.css">
 
  <link href="https://fonts.googleapis.com/css2?family=Marcellus&family=Roboto+Slab&family=Noto+Sans&display=swap" rel="stylesheet">
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

</head>
<body>

  <header class="header">
    <div class="container">
      <div class="logo">
        <img src="assets/img/logo2.png" width="325" height="279" alt=""/>
        <span></span>
      </div>
      <nav class="nav">
        <a href="#">Inicio</a>
        <a href="#">Nosotros</a>
        <a href="#">Servicios</a>
        <a href="#">Contacto</a>
      </nav>
      <button class="btn">Acci√≥n</button>
    </div>
  </header>
<section class="hero-carousel">
    <div class="slide active" style="background-image: url('assets/img/hero_4_2.jpg');">
      <div class="text-content">
        <h2>Yerbas Org√°nicas</h2>
        <p>De productores agroecol√≥gicos de Misiones</p>
      </div>
    </div>
    <div class="slide" style="background-image: url('assets/img/hero_4_3.jpg');">
      <div class="text-content">
        <h2>Proceso Artesanal</h2>
        <p>Estacionamiento natural entre 1 y 3 a√±os</p>
      </div>
    </div>
    <div class="slide" style="background-image: url('assets/img/hero_3.jpg');">
      <div class="text-content">
        <h2>Precios Congelados</h2>
        <p>Calidad premium al mismo valor del a√±o pasado</p>
      </div>
    </div>
  </section>

 <section class="hero2">
  <div class="imagenes-container" id="productos-container">
    <p>Cargando productos...</p>
  </div>
</section>

<script type="module">
  // === IMPORTS FIREBASE ===
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
  import { getFirestore, collection, getDocs, query, where, orderBy } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore.js";

  // === CONFIGURACI√ìN FIREBASE (la misma que tienes) ===
  const firebaseConfig = {
    apiKey: "AIzaSyDEpsW78ANRpnTQ9fZkwPQBUhYZVP2xw18",
    authDomain: "caleufuyerbamate.firebaseapp.com",
    databaseURL: "https://caleufuyerbamate-default-rtdb.firebaseio.com",
    projectId: "caleufuyerbamate",
    storageBucket: "caleufuyerbamate.firebasestorage.app",
    messagingSenderId: "690153593667",
    appId: "1:690153593667:web:b5f9d936f59f3c6336edf6"
  };

  // === INICIALIZACI√ìN ===
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // === CARGAR PRODUCTOS DESDE FIREBASE ===
  try {
    console.log('üî• Cargando productos desde Firebase...');
    
    // Consultar la colecci√≥n "productos" - solo productos activos
    const q = query(
      collection(db, "productos"), 
      where("activo", "==", true),
      orderBy("fechaCreacion", "desc")
    );
    
    const querySnapshot = await getDocs(q);
    const container = document.getElementById("productos-container");
    
    if (querySnapshot.empty) {
      container.innerHTML = "<p>No hay productos disponibles</p>";
    } else {
      container.innerHTML = ""; // Limpia el "Cargando..."
      
      querySnapshot.forEach((doc) => {
        const producto = doc.data();
        
        const tarjeta = document.createElement("div");
        tarjeta.className = "tarjeta";
        
        tarjeta.innerHTML = `
          <div class="tarjeta-inner">
            <div class="tarjeta-front">
              <img src="${producto.imagenFrente}" alt="Frente" />
              <div class="contenido-front">
                <h3>${producto.tituloFrente}</h3>
              </div> 
            </div>
            <div class="tarjeta-back">
              <img class="fondo" src="${producto.imagenReverso}" alt="Reverso" />
              <div class="contenido">
                <h3>${producto.tituloDetras}</h3>
                <p>${producto.subtituloDetras}</p>
                <button class="boton">${producto.textoBoton}</button>
              </div>
            </div>
          </div>
        `;
        
        container.appendChild(tarjeta);
      });
    }
    
    console.log('‚úÖ Productos cargados correctamente');
    
  } catch (error) {
    console.error('‚ùå Error al cargar productos:', error);
    document.getElementById("productos-container").innerHTML = 
      "<p>Error al cargar productos</p>";
  }
</script>

<script>
// Funci√≥n para detectar si el elemento est√° en viewport
function inViewObserver(className) {
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('in-view');
      }
    });
  }, {
    threshold: 0.60
  });
  document.querySelectorAll('.' + className).forEach(el => observer.observe(el));
}
inViewObserver('fade-up-on-scroll');
inViewObserver('fade-zoom-on-scroll');
</script>

  <section id="about" class="about-section">
  <div class="about-content">
    <div class="about-container">
      <div class="about-row">
        <div class="about-image-wrapper fade-zoom-on-scroll">
          <img src="assets/img/img_long_5.jpg" alt="Image" class="about-image">
        </div>
        <div class="about-text-wrapper fade-up-on-scroll">
          <h3 class="about-subtitle">Why Choose Us</h3>
          <h2 class="about-title">
            More than <strong>50 year experience</strong> in agriculture industry
          </h2>
          <p class="about-description">
            Reprehenderit, odio laboriosam? Blanditiis quae ullam quasi illum
            minima nostrum perspiciatis error consequatur sit nulla.
          </p>

          <div class="about-icons">
            <div class="about-icon-item">
              <div class="icon">üåßÔ∏è</div>
              <div>
                <h4>Plants needs rain</h4>
                <p>Lorem ipsum dolor sit amet.</p>
              </div>
            </div>

            <div class="about-icon-item">
              <div class="icon">‚ù§Ô∏è</div>
              <div>
                <h4>Love organic foods</h4>
                <p>Lorem ipsum dolor sit amet.</p>
              </div>
            </div>

            <div class="about-icon-item">
              <div class="icon">üè™</div>
              <div>
                <h4>Sell vegies</h4>
                <p>Lorem ipsum dolor sit amet.</p>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</section>
<div class="publicaciones-container"><p>Cargando publicaciones...</p></div>




      <script>
    const slides = document.querySelectorAll('.slide');
    let index = 0;

    setInterval(() => {
      slides[index].classList.remove('active');
      index = (index + 1) % slides.length;
      slides[index].classList.add('active');
    }, 5000);
  </script>
  
  

<script>
// Funci√≥n para detectar si el elemento est√° en viewport
function inViewObserver(className) {
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('in-view');
      }
    });
  }, {
    threshold: 0.60
  });

  document.querySelectorAll('.' + className).forEach(el => observer.observe(el));
}

inViewObserver('fade-up-on-scroll');
inViewObserver('fade-zoom-on-scroll');
</script>
<script type="module">
// === IMPORTS FIREBASE ===
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
import { getFirestore, collection, getDocs, orderBy, query, limit } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore.js";

// === CONFIGURACI√ìN FIREBASE ===
const firebaseConfig = {
  apiKey: "AIzaSyDEpsW78ANRpnTQ9fZkwPQBUhYZVP2xw18",
  authDomain: "caleufuyerbamate.firebaseapp.com",
  databaseURL: "https://caleufuyerbamate-default-rtdb.firebaseio.com",
  projectId: "caleufuyerbamate",
  storageBucket: "caleufuyerbamate.firebasestorage.app",
  messagingSenderId: "690153593667",
  appId: "1:690153593667:web:b5f9d936f59f3c6336edf6"
};

// === INICIALIZACI√ìN ===
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// === CARGAR SOLO LAS 3 PUBLICACIONES M√ÅS RECIENTES ===
async function cargarPublicacionesFirebase() {
  try {
    console.log("üî• Cargando las 3 publicaciones m√°s recientes...");
    
    const container = document.querySelector(".publicaciones-container");
    if (!container) {
      console.error("‚ùå No se encontr√≥ el contenedor");
      return;
    }

    container.innerHTML = "<p>Cargando publicaciones desde Firebase...</p>";

    // SOLO LAS 3 M√ÅS RECIENTES
    const q = query(collection(db, "publicaciones"), orderBy("fecha", "desc"), limit(3));
    const querySnapshot = await getDocs(q);

    container.innerHTML = '';

    if (querySnapshot.empty) {
      container.innerHTML = '<p style="text-align: center;">No hay publicaciones a√∫n.</p>';
      return;
    }

    querySnapshot.forEach((doc) => {
      const data = doc.data();
      
      let dia = "", mes = "", anio = "";
      if (data.fecha) {
        const fecha = data.fecha.toDate();
        dia = fecha.getDate().toString().padStart(2, '0');
        mes = (fecha.getMonth() + 1).toString().padStart(2, '0');
        anio = fecha.getFullYear().toString().slice(-2);
      }

      const tarjeta = document.createElement("div");
      tarjeta.className = "publicacion-card";
      tarjeta.innerHTML = `
        <div class="publicacion-wrapper" style="background-image: url('${data.imagenURL}');">
          <div class="publicacion-date">
            <span class="publicacion-day">${dia}</span>
            <span class="publicacion-month">${mes}</span>
            <span class="publicacion-year">${anio}</span>
          </div>
          <div class="publicacion-data">
            <div class="publicacion-content">
              <span class="publicacion-author">${data.autor}</span>
              <h3 class="publicacion-title">${data.titulo}</h3>
              <p class="publicacion-text">${data.descripcion}</p>
              ${data.link ? `
                <a href="${data.link}" target="_blank">
                  <button class="publicacion-button">Ver publicaci√≥n</button>
                </a>
              ` : `
                <button class="publicacion-button" style="opacity: 0.5;" disabled>Sin enlace</button>
              `}
            </div>
          </div>
        </div>
      `;
      container.appendChild(tarjeta);
    });

    console.log(`‚úÖ Mostradas las ${querySnapshot.size} publicaciones m√°s recientes`);
    
  } catch (error) {
    console.error("‚ùå Error:", error);
    const container = document.querySelector(".publicaciones-container");
    if (container) {
      container.innerHTML = '<p style="color: red;">Error al cargar publicaciones.</p>';
    }
  }
}

// === EJECUTAR ===
cargarPublicacionesFirebase();
</script>


</body>
</html>
